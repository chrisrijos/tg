<!DOCTYPE html>
<html>

<head>
    <!-- Startup configuration -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
    <title>@title</title>
    
    <script crossorigin="use-credentials">
        const loadTag = function (tagName, ...propertyAndValue) {
            const headElement = document.getElementsByTagName('head')[0];
            const newElement = document.createElement(tagName);
            propertyAndValue.forEach(propAndValue => newElement[propAndValue[0]] = propAndValue[1]);
            headElement.appendChild(newElement);
        };
        const loadScripts = function () {
            loadTag('link', ['rel', 'manifest'], ['href', '/resources/manifest.webmanifest']);
            loadTag('link', ['rel', 'icon'], ['sizes', '192x192'], ['href', '/resources/icons/tg-icon192x192.png']);
            loadTag('link', ['rel', 'apple-touch-startup-image'], ['href', '/resources/icons/tg-icon192x192.png']);
            loadTag('link', ['rel', 'apple-touch-icon'], ['href', '/resources/icons/tg-icon192x192.png']);
            loadTag('meta', ['name', 'msapplication-TileImage'], ['content', '/resources/icons/tg-icon144x144.png']); // Tile icon for Win8 (144x144)
            loadTag('script', ['src', '/resources/polymer/@webcomponents/webcomponentsjs/webcomponents-bundle.js'], ['async', 'true']);
            loadTag('script', ['src', '/resources/polymer/web-animations-js/web-animations-next-lite.min.js'], ['async', 'true']);
            loadTag('script', ['src', '/resources/filesaver/FileSaver.min.js'], ['async', 'true']);
            import('/resources/@startupResources.js');
        };
        if (@service-worker && 'serviceWorker' in navigator) {
            navigator.serviceWorker.register('/service-worker.js').then(function (registration) {
                if (registration.active) {
                    loadScripts();
                } else {
                    registration.onupdatefound = function () {
                        const installingWorker = registration.installing;
                        installingWorker.onstatechange = function () {
                            if (installingWorker.state === 'activated') {
                                loadScripts();
                            }
                        };
                    };
                }
            });
        }
    </script>
    
    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="@title">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="@title">
    <script>
        window.TG_APP = {
            watermark: @watermark
        };
    </script>
    <custom-style>
        <style include="iron-flex iron-flex-reverse iron-flex-alignment iron-flex-factors iron-positioning">
            html {
                font-size: 10pt;
                @panelColor
                --tg-watermark-style: {
                    @cssStyle
                };
            }
            body {
                font-family: 'Roboto', 'Helvetica Neue', Helvetica, Arial, sans-serif;
                font-size: 10pt;
            }
            tg-app-template {
                height: 100vh;
            }
        </style>
    </custom-style>
</head>

<body unresolved class="fullbleed">
    <tg-app-template class="layout vertical" app-title="@title"></tg-app-template>
</body>

</html>