<link rel="import" href="/resources/polymer/polymer/polymer.html">
<link rel="import" href="/resources/polymer/paper-icon-button/paper-icon-button.html">
<link rel="import" href="/resources/polymer/iron-icons/iron-icons.html">
<link rel="import" href="/resources/polymer/paper-styles/paper-styles.html">

<dom-module id="tg-message-panel">
    <style>
        :host {
            padding: 8px;
            @apply(--layout-horizontal);
            @apply(--layout-center);
            @apply(--layout-justified);
            background-color: var(--paper-yellow-a100);
        }
        .mesage-panel {
            color: var(--paper-grey-600);
            font-size: 16px;
        }
        .close-button {
            width: 22px;
            height: 22px;
            padding: 0px;
            --paper-icon-button: {
                color: var(--paper-grey-600);
            };
            --paper-icon-button-disabled: {
                color: var(--paper-grey-400);
            };
            --paper-icon-button-hover: {
                color: var(--paper-grey-400);
            };
        }
    </style>
    <template>
        <div class="mesage-panel flex layout horizontal center-center">Chrome is highly recommended for this application.</div>
        <paper-icon-button hidden="[[_closerHidden(_lastAction, mobile)]]" class="close-button" icon="icons:cancel"  on-tap="_closeMessage" tooltip-text="Close Message"></paper-icon-button>
    </template>
</dom-module>
<script>
    (function () {
        
        const isMobile = {
            Windows: function() {
                return /IEMobile/i.test(navigator.userAgent);
            },
            Android: function() {
                return /Android/i.test(navigator.userAgent);
            },
            BlackBerry: function() {
                return /BlackBerry/i.test(navigator.userAgent);
            },
            iOS: function() {
                return /iPhone|iPad|iPod/i.test(navigator.userAgent);
            },
            any: function() {
                return (isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Windows());
            }
        };
       

        Polymer({

            is: "tg-message-panel",

            properties: {
                isRecomendedClient: {
                    type: Boolean,
                },
                
                closed: {
                    type: Boolean,
                }
            },
            
            observers: ["_shoudDisplayMsg(isRecomendedClient, closed)"],

            ready: function () {
                const isSafari = /constructor/i.test(window.HTMLElement) || (function (p) { return p.toString() === "[object SafariRemoteNotification]"; })(!window['safari'] || (typeof safari !== 'undefined' && safari.pushNotification));
                const isChrome = !!window.chrome && !!window.chrome.webstore;
                this.isRecomendedClient = isMobile.any() || isSafari || isChrome;
                this.closed = this.isRecomendedClient;
            },
            
            _closeMessage: function (e) {
                this.closed = true;
            },
            
            _shoudDisplayMsg: function (isRecomendedClient, closed) {
                if (isRecomendedClient || closed) {
                    this.setAttribute("hidden", true);
                } else {
                    this.removeAttribute("hidden");
                }
            }
            
        });
    })();
</script>